<!DOCTYPE html>
<html lang="en-US">
<head>
    <title>lang-devbr</title>
    <link rel="shortcut icon" href="favicon.ico" />
    <style>
        @import url("https://fonts.googleapis.com/css?family=Roboto+Mono");

        body {
            margin: 0;
            padding: 0;
            font-family: Roboto Mono,monospace;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-direction: column;
            flex-direction: column;
            min-height: 100%;
            background-color: white;
            color: black;
            font-size:small;
        }

        a {
            color: black;
        }

        .dark-mode {
            background-color: #403d3d;
            color: white;
        }

        .dark-mode-a {
            color: white;
        }
    </style>
</head>
<body>
    <p></p>
    <center>
        <img id="imgPerfil" alt="perfil" style="border-radius: 50%;border: 1px solid #0000002f;" width="200" />
        <span id="userInfo"></span>
        <p>=============================================</p>
        <p>Find me on LinkedIn or GitHub:</p>
        <div style="width: 100%; display: inline-block;">
            <div style="display: inline-block;">
                <a href="https://github.com/lang-devbr" target="_blank">
                    <img alt="github" src="images/github.png" width="30" />
                </a>
            </div>
            <div style="display: inline-block;">
                <a href="https://www.linkedin.com/in/luiz-lang/" target="_blank">
                    <img alt="linkedin" src="images/linkedin.png" width="30" />
                </a>
            </div>
        </div>
        <p>Check some of my repositories on GitHub:</p>
        <ul id="listRepos" style="list-style: none;"></ul>
        <p>=============================================</p>
        <div style="width: 100%; display: inline-block;">
            Â©
            <span style="font-size:x-small;">
                Copyright - <span id="copyYear"></span>.
            </span>
        </div>
    </center>
    <div style="position:fixed;top:1px;right:15px">
        <p style="width: auto">
            <div style="cursor:pointer;width:1%">
                <img id="btnDark" src="images/sun.png" alt="dark mode" onclick="setDarkMode();" width="20" />
            </div>
        </p>
    </div>
</body>
</html>
<script type="text/javascript">

    var apiUrl = "https://api.github.com/users/lang-devbr";
    setCopyrightYear();
    getReposInfo();
    getOwnerInfo();
    setLoadDarkMode();

    function setLoadDarkMode() {
        var element = document.body;
        const darkMode = localStorage.getItem("darkMode");

        if (darkMode == "true") {
            document.getElementById("btnDark").setAttribute("src", "images/sun-light.png");
            element.className = "dark-mode";
        }
    }

    function setLinkColor(item) {
        item.classList.toggle("dark-mode-a");
    }

    function setDarkMode() {
        var element = document.body;
        element.classList.toggle("dark-mode");
        const a = document.querySelectorAll("a");
        a.forEach(setLinkColor);
        var value = document.getElementById("btnDark").getAttribute("src");
        var imageSun = "images/sun" + (value == "images/sun.png" ? "-light" : "") + ".png";
        document.getElementById("btnDark").setAttribute("src", imageSun);
        localStorage.setItem("darkMode", (value == "images/sun.png" ? true : false));
    }

    function setCopyrightYear() {
        var copyYear = document.getElementById("copyYear");
        var year = new Date().getFullYear();
        copyYear.innerHTML = year.toString();
    }


    function getOwnerInfo() {
        fetch(apiUrl).then(response => {
            return response.json();
        }).then(data => {

            var imgPerfil = document.getElementById("imgPerfil");
            imgPerfil.setAttribute("src", data.avatar_url);

            var userInfo = document.getElementById("userInfo");
            var name = document.createElement("p");
            var bio = document.createElement("p");
            var work = document.createElement("p");
            var email = document.createElement("p");

            name.innerHTML = data.name;
            bio.innerHTML = data.bio;
            work.innerHTML = data.company;
            email.innerHTML = data.email;

            userInfo.appendChild(name);
            userInfo.appendChild(bio);
            userInfo.appendChild(work);
            userInfo.appendChild(email);

        }).catch(err => {
            console.log(err);
        });
    }

    function getReposInfo() {
        fetch(apiUrl.concat('/repos')).then(response => {
            return response.json();
        }).then(data => {

            const darkMode = localStorage.getItem("darkMode");

            for (item in data) {

                //Removing some default repos, this exists only for overview on my github
                if (data[item].name.includes("lang-devbr")) {
                    continue;
                }

                var node = document.createElement("li");
                var link = document.createElement("a");
                link.href = data[item].owner.html_url.concat("/").concat(data[item].name);
                link.text = data[item].name;

                if (darkMode == "true") {
                    link.className = "dark-mode-a";
                }

                link.target = "_blank";
                node.appendChild(link);
                document.getElementById("listRepos").appendChild(node);
            }
        }).catch(err => {
            var node = document.createElement("li");
            var textNode = document.createTextNode(err);
            node.appendChild(textNode);
            document.getElementById("listRepos").appendChild(node);
        });
    }
</script>
